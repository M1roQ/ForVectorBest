# Предобработка изображений

### Описание
<img src="assets/bad_example.jpg" alt="bad example" align="right" width=40%>
При работе с изображениями возникает проблема, некоторые деффекты хорошо видны для человека, но модели не могут их обнаружить, т.к. деффекты весьма бледные и размытые. Следовательно возникает идея как-то выделить всё, что можно считать символами элементов оформления и сделать их более явными для модели. Подобное выделение основных признаков должно улучшить дальнейшее обучение модели. Разработке/подбору такого фильтра и посвящена данная ветвь проекта.

### Критерии "хорошести" алгоритма
- Точно находит и выделяет элементы оформления
- Находит и выделяет различные загрязнения, размытости (серые цвета)
- Не выделяет ничего лишнего на этикетке
- Не размывает качественно распечатанные элементы

<img src="assets/result_example.png" alt="result" align="right" width=40%>

### Текущее решение (этап разработки: тестирование)
На данный момент наиболее хороший результат выдаёт следующий алгоритм:
1. Переводим переданное изображение в grayscale стандартным способом
2. Находим все уникальные цвета и их количсетво на чёрно-белом изображении
3. Определяем среднее значение по массиву количества уникальных цветов
4. Далее отсекаем все цвета, количество которых меньше среднего либо находится в "чёрной зоне" (на данный момент это все значения < 0.3)
5. Находим минимальное значение > 0 на оставшихся значениях - это точка, отсекающая группу пикселей "фон" от несущих информацию
6. Все значения больше этой точки заменяются на 0, остальные на 1
7. Маска элементов оформления готова

Также были протестированы решения на основе на основе свёртки с размерами ядра от 3 до 5 и функцией std для этого ядра и выделения цветов из чёрно-белой зоны RGB палитры, но оба способа не подошли под критерии, описанные выше.

### TODO:
- Протестировать эти маски с моделью
