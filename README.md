# ForVectorBest

### Описание:
Задача на классификацию. Определение бракованных (плохих) и хороших этикеток.
В данной ветке разарбатывается решение на основе предобученной ResNet50 из фреймворка pytorch. У модели дообучаются последние слои, отвечающие за классификацию признаков.

### Директории:
#### stickers
Датасет проекта, содержит изображения, используещиеся в процессе обучениия модели. Имеет 3 поддиректории с тренировочной, тестовой и валидационной частями, в каждой из них есть ещё две директории: Bad и Good с "плохими" и "хорошими" картинками соответсвенно.

#### model
Папка содержит веса, показавшие наилучший рзезультат во время обучения, а так же файл `results.json` и графики с визуализацией json файла.

#### work
Директория для сохранения результатов обучения. В неё будут сохраняться наборы метрик и промежуточные веса, полученные в процессе работы `main.py`.
Не хранится в репозитории, актуальные данные для использования можно найти в папке `model` в ветке с моделью (на данный момент только resnet50)

### Cкрипты:
Работа ведётся на фрэймворке pytorch, полный список зависимостей есть в environment.yml (для запуска программ из данной ветки рекомендуется использовать conda окружение, созданное на основе этого файла `conda env create -f environment.yml`)

#### dataset.py
Скрипт хранит классы и функции, необходимые для работы с датасетом, используется в других скриптах в качестве подключаемого модуля. Не предполагает самостоятельного запуска.
Через данный скрипт ведётся насройка параметров датасета и препроцессинга передаваемых изображений.

#### visual.py
Скрипт визуализирует процесс обучения модели на основе файла `results.json` и создаёт файл `results.png` в той же директории, что и .json файл.

Пример запуска:
```
python3 visual.py -p model/results.json
```

#### predict.py
Скрипт загружает переданные веса и делает предсказание на основе переданного изображения, использует данные из `dataset.py` для препроцессинга входного изображения.

Пример запуска:
```
python3 predict.py -w model/resnet50_best.pth -i test_image.png
```

#### main.py
Служит для дообучения модели, содержит основной обучающий цикл. Класс датасета и дополнительную информацию по данные берёт из `dataset.py`. Веса и json файл с результатами обучения сохраняются в папку `work/<год><месяц><число>_<часы><минуты><секунды>` (временные метрики берутся в момент запуска обучения)

Пример запуска:
```
python3 main.py
```
